<!doctype html>
<html lang="en">
  <head>
    
     <!-- Required meta tags -->
     <meta charset="utf-8">
     <meta name="viewport" content="width=device-width, initial-scale=1">
 
     <!-- Bootstrap CSS -->
      <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.css'  rel="stylesheet">
     <script src=  'https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js'>
     </script>
       
     <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'>
     </script>
     

     <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
     {% load static %} 
     <link rel="stylesheet" href="{% static 'css/styles.css' %}">

    <title>Construction</title>
  </head>
  <body>

    
    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

    <nav class="navbar navbar-expand-lg navbar-dark" style="background-color: #343b50;">
      <div class="container-fluid">
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link "  href="/">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link "  href="/results">Dashboard</a>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link  dropdown-toggle" href="/clusteringkmeans" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                  Clustering
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a class="dropdown-item " href="/clusteringkmeans">K-means</a></li>
                <li><a class="dropdown-item" href="clusteringKmodes">K-modes</a></li>
                
              </ul>
            </li> 
            <li class="nav-item">
              <a class="nav-link "  href="/association">Association</a>
            </li>

           
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="/construction">Apprentissage</a>
            </li>

            <li class="nav-item">
              <a class="nav-link " aria-current="page" href="/classification">Prédiction</a>
            </li>
            
          </ul>
          
        </div>
      </div>
    </nav>
  

      <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="col-11 col-sm-9 col-md-7 col-lg-6 col-xl-5 text-center p-0 ">
                <div class="card px-0 pt-4 pb-0 ">
                    <form  class="needs-validation" id="msform"  method="POST" enctype="multipart/form-data" >
                      <!-- progressbar -->
                        <!-- <ul id="progressbar">
                           
                            <li id="payment"><strong>Apprentissage</strong></li>
                            <li id="confirm"><strong>Résultat</strong></li>
                        </ul> -->
                        <!-- <div class="progress">
                            <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>  -->
                        <br> 
                        <!-- fieldsets -->
                        
                       
                        <fieldset>
                            <div class="form-card">
                            <div class="row ">
                                  <h3 class="fs-title">Choix du classifieur :</h3>   
                             </div>
                             <div class="row ">
                                   <select id="classif" class="form-select" name="classif" required aria-label="select example" style="width:15;">
                                   <option value="svm">SVM</option>
                                   <option value="kpp">KPP</option>
                                   <option value="rna">RNA</option>
                                   <option value="mlknn">MLKNN</option>
                                   <option value="brrf">RF {BR}</option>
                                   <option value="brsvm">SVM {BR}</option>
                                   <option value="brknn">KNN {BR}</option>
                                   <option value="brmlp">MLP {BR}</option>
                                   <option value="lprf">RF {LP}</option>
                                   <option value="lpsvm">SVM {LP}</option>
                                   <option value="lpknn">KNN {LP}</option>
                                   </select>
                             </div>  
                              
                            
                              <div class="row ">
                                <h3 class="fs-title">Niveau de classification :</h3>  </div> 
                             <div class="row ">
                                   <select id="nvclass" name="nvclass" class="form-select" required aria-label="select example" style="width:15;">
                                   <option value="p"selected>Polarité</option>
                                   <option value="ta">Aspect</option>
                                   <option value="ts">Sentiment</option>
                                   <option value="at">Attitude</option>
                                   <option value="t">Valeur</option>
                                   <option value="e">Attente</option>
                                  
                                    <!-- zzz -->
                                   
                                   </select>
                             </div>                            
                             </div> 
                             <input type="button" name="suivant" class="next action-button" value="Terminer" /> <input type="button" name="retour" class="previous action-button-previous" value="Retour" />
                        </fieldset>
                        <fieldset>
                            <div class="form-card">
                                 <br>
                                <!-- <h2 class="purple-text text-center"><strong>SUCCESS !</strong></h2> <br> -->
                                <div class="row justify-content-center"> 
                                    <div class="col-3 " id="success" style="visibility: hidden; display: none;"> <img src="https://i.imgur.com/A8B9uFb_d.webp?maxwidth=760&fidelity=grand" class="fit-image" > </div>
                                    <div class="col-3 " id="wait"> <img src="https://icon-library.com/images/waiting-icon-gif/waiting-icon-gif-1.jpg" class="fit-image"> </div>
                                </div> <br>
                                <div class="row justify-content-center">
                                    <div class="col-7 text-center" id="modele">
                                        <h5 class="purple-text text-center" > </h5>
                                    </div>
                                </div>
                               
                            
                            <div class="row justify-content-center">
                             <a href="{% url 'Construction' %}"  id="new" class="md" role="button" aria-pressed="true" style='text-decoration:none;text-align: center;visibility: hidden; display: none;' >Nouveau Modele</a>
                             <a href="{% url 'Classification' %}" id="res" class="md" role="button" aria-pressed="true" style='text-decoration:none;text-align: center;visibility: hidden; display: none;'>Voir Résultats</a>
                            </div>
                          </div>
                        </fieldset> 
                        <button class="btn " id="ok" type="submit" hidden >OKK</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="footer">
      <p style="color: #ffffff;">Copyright © Analysis of learners' behaviors and emotions in an online course 2021</p>
    </div> 

        <!-- <div class="container">     
          <div style="max-height: 300px;
          overflow: auto;
          display:inline-block;">  
          <table class="table table-bordered table-striped mb-0" id="#tablepret">
            <thead>
              <tr>
                <th>Commentaire</th>
                <th>Séance</th>
                <th>Module</th>
                <th>Aspect</th>
                <th>Polarité</th>
                <th>Sentiment</th>
                <th>Attitude</th>
                <th>CommentaireP</th>
              </tr>
            </thead>
            <tbody>
            <-- jinja2 Technique -->
            <!-- {% if d %}  
            {% for i in d %}
              <tr>
                <td>{{i.Commentaire}}</td>
                <td>{{i.Séance}}</td>
                <td>{{i.Module}}</td>
                <td>{{i.Aspect}}</td>
                <td>{{i.Polarité}}</td>
                <td>{{i.Sentiment}}</td>
                <td>{{i.Attitude}}</td>
                <td>{{i.CommentairePrep}}</td>
              </tr>
            {% endfor %}
            {% endif %}
            </tbody>
          </table>
      </div> 
      </div> --> 
    <div class="modal" tabindex="-1" id="examplepret" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Résultats des prétraitements</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            
              <div class="container">     
                <div style="max-height: 400px;
                overflow: auto;
                display:inline-block;"> 
              <table class="table table-hover table-bordered  mb-0" id="myTable" style="visibility: hidden; display: none;">
                <tr  style="background-color: #4bc0c0;">
                  <th>Commentaire</th>
                  <th>Commentaire_Prétraité</th>
                </tr>
             </table>
             <!-- <div id="wait1" style="margin-left: 90px;"> 
               <img src="https://icon-library.com/images/waiting-icon-gif/waiting-icon-gif-1.jpg" class="fit-image">
              </div> -->
              <div id="wait1" style="margin-left: 180px;" class="lds-ellipsis"><div></div><div></div><div></div><div></div></div>
            </div>
          </div>
          <div class="modal-footer">
            <input type="button" id="savepre" class="md " value="Sauvgarder" disabled/>
          </div>
        </div>
      </div>
    </div>
   </div>
      
        
   
<script>
$(document).ready(function(){

var current_fs, next_fs, previous_fs; //fieldsets
var opacity;
var current = 1;
var steps = $("fieldset").length;

setProgressBar(current);

$(".next").click(function(){
if ($(this).val() == "Terminer")
{
  document.getElementById('ok').click();
  
}
current_fs = $(this).parent();
next_fs = $(this).parent().next();

//Add Class Active
$("#progressbar li").eq($("fieldset").index(next_fs)).addClass("active");

//show the next fieldset
next_fs.show();
//hide the current fieldset with style
current_fs.animate({opacity: 0}, {
step: function(now) {
// for making fielset appear animation
opacity = 1 - now;

current_fs.css({
'display': 'none',
'position': 'relative'
});
next_fs.css({'opacity': opacity});
},
duration: 500
});
setProgressBar(++current);
});

$(".previous").click(function(){

current_fs = $(this).parent();
previous_fs = $(this).parent().prev();

//Remove class active
$("#progressbar li").eq($("fieldset").index(current_fs)).removeClass("active");

//show the previous fieldset
previous_fs.show();

//hide the current fieldset with style
current_fs.animate({opacity: 0}, {
step: function(now) {
// for making fielset appear animation
opacity = 1 - now;

current_fs.css({
'display': 'none',
'position': 'relative'
});
previous_fs.css({'opacity': opacity});
},
duration: 500
});
setProgressBar(--current);
});

function setProgressBar(curStep){
var percent = parseFloat(100 / steps) * curStep;
percent = percent.toFixed();
$(".progress-bar")
.css("width",percent+"%")
}


$('#msform').on('submit', function(e){
// Let's see the values
//alert($(this).serialize());
e.preventDefault();
      
      $.ajax({
           type : "POST", 
           url: "{% url 'modele_creation' %}",
           data: {
            donnee: JSON.stringify($("#msform").serializeArray()),
            
            csrfmiddlewaretoken: '{{ csrf_token }}',
            dataType: "json",
    
           },
           
           success: function(data){
              $("#success").css("visibility", "visible");
              $("#success").css("display", "table");
              $("#new").css("visibility", "visible");
              $("#new").css("display", "table");
              $("#res").css("visibility", "visible");
              $("#res").css("display", "table");
              $("#wait").css("visibility", "hidden");
              $("#wait").css("display", "none");
              $('#modele').html(data.msg);
              $('#modele').val(data.msg);
              $('#modele').show();
            
            },
    
           failure: function() {
               
           }    
      });
    });   
    

    $('#examplepret').modal({backdrop: 'static', keyboard: false})    
    $("#savepre").click(function(){ document.getElementById('gonext').click();
    $('#examplepret').modal('hide'); });
    
    $(".pretraitement").click(function(){
        
      $('#examplepret').modal('show');
      
        
      $.ajax({
           type : "POST", 
           url: "{% url 'corpus_pretraitement' %}",
           data: {
            filtrage : $('#F').prop('checked'),
            lemmatisation:  $('#L').prop('checked'),
            mots : $('#V').prop('checked'),
            
            csrfmiddlewaretoken: '{{ csrf_token }}',
            dataType: "json",
    
           },
           
           success: function(data){
            
              
              $("#wait1").css("visibility", "hidden");
              $("#wait1").css("display", "none");
              $("#savepre").attr('disabled', false);    

            var json = $.parseJSON(data);
            for (var i=0; i<json.length; i++) {
            var row = $('<tr><td>' + json[i].Commentaire+ '</td><td>' + json[i].CommentairePrep + '</td></tr>');
            $('#myTable').append(row);
            $("#myTable").css("visibility", "visible");
            $("#myTable").css("display", "table");
                                               } 
                                               
            //$('#examplepret').modal('show'); 
           },
    
           failure: function() {
               
           } 
        
      }); 
    });
});     
</script>

</body>
</html>